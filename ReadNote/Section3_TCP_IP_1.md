# TCP-IP详解卷1： 协议  

## 概述 
__协议簇:__ 是一组不同层次上的多个协议的组合   

* TCP/IP 协议： 链路层， 网络层， 运输层， 应用层  
    * 链路层：  
        _数据链路层或网络接口层_, 通常包括操作系统中的设备驱动程序和计算机中对应的网络接口卡。 一起处理与电缆的物理接口细节  
    * 网络层：  
        包括 `IP`(网际协议), `ICMP`(internet互联网控制报文协议), `IGMP`(internet组管理协议)    
    * 运输层： 
        主要为两台机器应用程序提供端到端的通信。包含 `TCP` 协议和 `UDP` 协议   
        * TCP: 
            提供高可靠性的数据通信，负责将应用程序交给它的数据分成合适的小块交给下边的网络层，确认接收到的分组，发送确认
    * 应用层：  
        处理特定的应用程序细节， 一般提供一下几种应用： 
        * Telnet 远程登录  
        * FTP 文件传输协议  
        * SMTP 简单邮件传送协议  
        * SNMP 简单网络管理协议   
    __在TCP/IP协议簇中，网络层IP 提供的是一种不可靠服务。它只是尽可能快的把分组从源节点送到目的节点，并不提供任何可靠性保证。TCP在不可靠的IP层上提供了一个可靠的运输层。为提供这种可靠性，TCP采用了超时重传， 发送和接收端到端的确认分组等机制__  

__网桥:__ 另外一种连接网络的方式。  
__网桥在链路层上对网络进行互连， 路由器则是在网络层上对网络进行互连。__ 网桥使得多个局域网组合在一起， 对上层来说好像是一个局域网   

TCP/ IP 倾向于使用路由器而不是网桥来连接网络。   


### TCP/IP 分层  
![TCP/IP协议簇中不同层次的协议](.././assets/read_note/TCP:IP/截屏2020-02-27下午10.23.53.png)  
* `TCMP`： 是IP协议的附属协议， IP层用它来与其他主机或路由器交换错误报文和其他重要信息。尽管ICMP主要被IP 使用，但其他应用程序也可能访问(Ping和Traceroute等程序)  
* `TGMP`:是Internet 组管理协议。把一个UDP数据报多播到多个主机   

### 互联网的地址   
互联网中每个接口必须有一个唯一的地址(IP地址)。 __IP地址长 32 bit__   
![五类互联网地址](.././assets/read_note/TCP:IP/截屏2020-02-27下午10.33.55.png)    

![各类IP地址范围](.././assets/read_note/TCP:IP/截屏2020-02-27下午10.35.44.png)



## IP： 网际协议 
* 不可靠： 
    不能保证IP 数据报能成功到达目的地。仅提供最好的传输服务。任何要求的可靠性必须由上层来提供(例如TCP)  
* 无连接  
    IP 并不维护任何关于后续数据报的状态信息。每个数据报的处理是相互独立的。__IP数据报可以不按发送顺序接收__  

### IP 首部  
![首部数据各字段](.././assets/read_note/TCP:IP/截屏2020-03-01下午6.14.18.png)
__big endian字节序(网络字节序):__ 即 上图中所示的 4个字节的 32 bit 值以 __0 ~ 7 bit, 其次 8 ~ 15 bit,然后 16 ~ 23 bit， 最后是 24 ~ 31 bit__ 的方式传输。TCP/IP 首部中所有的二进制证书在网络中传输时都要求以这种次序传输

_以太网的最小帧是 46 字节_  
* 版本号： 
    目前版本号是 4  
* 首部长度  
    首部占 32 bit 字的数目，包括任何选项，由于是 4bit字段，因此首部最长为 60 字节。  
* 总长度字段 
    指整个IP数据报的长度，以字节为单位。(总长度和首部长度计算出数据内容的长度)。由于此字段长 16 bit， 所以IP 数据报最长可达  65535 字节(大多数链路层都会对其进行分片)，__主机要求不能接收超过 576 字节的数据报__   
* TTL 
    设置数据报可以经过的最多路由器数。指定了数据报的生存时间。__该字段值为0 ，数据报就会被丢弃__  
