
# 越狱环境监测  



## 方式1  
检测是否安装 `Cydia`  

```Objective-C
if([[NSFileManager defaultManager]fileExistsAtPath:@"/Applications/Cydia.app"]){

    // 已越狱
}else {
    // 未越狱  
}
```

## 方式2 
检测多种路径  
```

+(BOOL)jailbreak{
    // 检测环境变量 
    // mac 和 iOS 可以通过设置 `DYLD_INSERT_LIBRARIES` 环境变量，重写动态链接库种的函数，实现hook 功能，
    // 如果有次变量，说明动态库被更改了  
    if(getenv("DYLD_INSERT_LIBRARIES")) return YES; 

    // 检测越狱种常见的文件、文件夹是否存在  
    static const char* pathes[] = {
        "/Applicaitons/Cydia.app",
        "Library/MobileSubstrate/MobileSubstrate.dylib",
        "var/lib/cydia",
        "var/lib/apt",
        "var/cache/apt",
        "/etc/apt",
        "/bin/bash",
        "/bin/sh",
        "/usr/sbin/sshd",
        "/usr/libexec/ssh-keysig",
        "/etc/ssh/sshd_config"  
    }

    static const int pachCount = sizeof(paths)/ sizeof(path[0]);

    // 文件信息 
    struct stat statInfo; 
    // 便利  
    for(int i = 0; i < paths; i++) {
        if (stat(paths[i], &statInfo)==0) return yes; 
    }

}

```
 