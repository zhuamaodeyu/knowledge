# 脱壳  




## 加壳  
IPA----> app store (对应用进行加壳(加密操作))   
加壳： 利用特殊的算法，针对可执行文件的编码进行改变，以达到保护的目的  


#### 加壳前  
可执行文件 -----> 内存(可执行文件)   

#### 加壳后  
可执行文件 ----->壳程序---->解密 -----> 内存(可执行文件)  



#### 验证是否加壳  
Mach-O  文件中`Load commands`中`LC_ENCRYPTION_INFO_64`  字段标记中的 `Crypt_ID > 0` 就说明使用了加密算法   
`otool -l XXXXX | grep crypt`



## 脱壳  
将未加密的文件还原回来   

### 硬脱壳  
直接执行解密算法

### 动态脱壳  
执行程序，然后将内存中的可执行文件导出   



### 脱壳工具  
* Cluth    
    * 安装 
        将此文件放到手机的 `/usr/bin`目录下  
    * 权限设置 
        `chmod +x /usr/bin/Clutch` 
* dumpdecrypted  
    * 下载源码进行编译 
        `make` 
    * 将动态库放入手机中  
        `/var/root` 
    * 终端进入 dylib所在的目录  
    * 使用环境变量注入动态库到需要脱壳的程序中  
        `DYLD_INSERT_LIBRARIES=dumpdecrypted.dylib 可执行文件路径`   
        注：可执行文件路径可通过`ps -A` 查看  
* AppCrackr(过时) 
* Crackulous(过时)  



