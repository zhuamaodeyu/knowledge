# 插件主题样式  



```js 

var csInterface = new CSInterface();
var skinInfo = csInterface.getHostEnvironment().appSkinInfo;
var bgColor = skinInfo.panelBackgroundColor.color;
var body = document.getElementById('body');
body.style.backgroundColor = `rgb(${bgColor.red}, ${bgColor.green}, ${bgColor.blue})`;

```

> skinInfo 里头包含了当前主题下面板的颜色色值，对应的数据结构如下，我们可以通过获取到里面的appBarBackgroundColor 和 panelBackgroundColor两个颜色的色值来设置我们的面板，以使得面板颜色和Ps主题颜色保持一致。







## 监听photoshop 主题更改事件 `com.adobe.csxs.events.ThemeColorChanged `  

```js 

var csInterface = new CSInterface();

// 把修改颜色包装成一个函数
function syncTheme() {
    var skinInfo = csInterface.getHostEnvironment().appSkinInfo;
    var bgColor = skinInfo.panelBackgroundColor.color;
    var body = document.getElementById('body');
    body.style.backgroundColor = `rgb(${bgColor.red}, ${bgColor.green}, ${bgColor.blue})`;
}

window.addEventListener('load', () => {
    syncTheme();
    // 监听Ps的主题变化事件
    csInterface.addEventListener('com.adobe.csxs.events.ThemeColorChanged', () => {
        syncTheme();
    });
});

```



## 使用 Topcoat 管理样式 
> 由于需要考虑背景色的同时，也需要考虑前景色，所以减少工作量，使用框架来完成  



```js 


// 通过获取到的颜色来判断当前主题 darkest/dark/gray/white
function getTheme() {
    var hostEnv = csInterface.getHostEnvironment();
    var bgColor = hostEnv.appSkinInfo.appBarBackgroundColor;
    var red = Math.round(bgColor.color.red);
    var green = Math.round(bgColor.color.green);
    var blue = Math.round(bgColor.color.blue);
    var theme;
    if (red < 60) {
        theme = 'darkest';
    } else if (60 <= red && red < 127) {
        theme = 'dark';
    } else if (127 <= red && red < 200) {
        theme = 'gray';
    } else {
        theme = 'white';
    }
    return theme;
}

// 动态替换整个Css文件
function syncTheme2() {
    var theme = getTheme();
    var link = document.getElementById('theme-link');
    link.href=`./css/topcoat/topcoat-desktop-${theme}.min.css`;
}

```




## React Spectrum  
> Mac事件无响应的问题： `delete window.PointerEvent;`